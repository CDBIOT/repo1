
<html>
    <head>
    <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="css/css.css" />
        <link rel="stylesheet" type="text/css" href="css/reset.css" />
        <script src="user.js"></script>

    <title>Cadastro de usuarios</title> 
    </head>
    <body >
    <div class="botao_home">
        <form name="home" action="/" method="get">
            <div class="home_btn">
            <input type="image" src="imagens/blue/home_btn.png" onClick="this.form.submit()">
            </div>
        </form>
    </div>

<div class = "cad">
	<div class = "box_cad">
	<form action="/cadastrar" method = "post">
		<p><label>Cadastrar Usuario</label></p><br>
		<input type="text" placeholder="Nome"	name = "nome" size="20" > <br>
		<input type="text" placeholder="E-mail" name = "email" size="20" > <br>
		<input type="text" placeholder="Senha" name = "senha0" size="20" > <br><br>
	
		<input type="checkbox" name = "agreement" id="agreement" >
		<label for="agreement">Eu li e aceito os <a href= "#" >termos de uso</a></label><br><br>
		<button type="submit"> Cadastrar </button>
        </form>
       
	</form>
	</div>

	<div class = "box_control">
		<form action="/user" method = "get">
			<label>Consultar</label><br>
			<input type="text" id="token"  name = "token" > <br>
			<button type="button"  onClick = "autentica()">Listar</button>
		</form>
	
		<form action="/user" method = "patch">
			<br><label>Altera</label><br>
			<input type="text"  placeholder="Nome" name="nome" size="20" > <br>
			<input type="text"  placeholder="E-mail" name="email" size="20" > <br>
			<input type="text"  placeholder="Senha" name="senha0" size="20" > <br>
			<button type="submit">Alterar </button>
		</form>
	

	<form action="/user" method = "delete">
		<br><label>Deletar</label><br>
			<input type="text" placeholder="Id"  id ="id" name = "id" size="20" > 
			<button type="submit">Deletar</button>
	</form>

	</div>
</div>
</body>

<script>

	async function autentica() {
		//requisição de token para pagina login

		let token = document.getElementById('token').value;
		localStorage.setItem =("token",token);
		var myHeaders = new Headers();
			//myHeaders.append("Authorization", "Bearer " + localStorage.getItem(token));
			myHeaders.append("Authorization", "Bearer " + token); //pega token enviado pelo formulário
			const options = {
							method: 'GET',
							mode: 'cors',
							cache: 'default',
							headers: myHeaders,
							redirect: 'follow'
							};

			//fetch('https://polar-beyond-82520.herokuapp.com/user',options)
			fetch('http://127.0.0.1:8081/user',options)
			.then(response=>response.text())
			.then(result => console.log(result))
  			.catch(error => console.log('error', error));
			}
		





</script>
</html>
